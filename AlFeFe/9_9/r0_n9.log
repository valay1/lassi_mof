#INFO: **** input file is /project/lgagliardi/valayagarawal/lasscf/mof_nodes/Al_Fe_Fe/production/9_9/lassi_r0_r9.py ****
import numpy as np
import sys
from pyscf import gto, scf, tools,lib, mcscf
from pyscf.mcscf import avas,project_init_guess
from pyscf import mcscf
from mrh.my_pyscf.tools import molden
from mrh.my_pyscf.mcscf import lasscf_async as asyn
mol_name='Al_Fe_Fe.xyz' # Al-Fe-Fe MOF node
basis={'C': 'cc-pvdz','H': 'cc-pvdz','O': 'cc-pvtz','Al': 'cc-pvtz','Fe': 'cc-pvtz'}
r=0;n=9
output='r'+str(r)+'_n'+str(n)+'.log'
mol=gto.M(atom=mol_name,verbose=4,spin=9,charge=0,basis=basis, output=output) #spin = 2S
mf=scf.RHF(mol)
mf=mf.density_fit()
mf.max_cycle=1
mf.kernel()
mf.mo_coeff=np.load('hf.npy')

mo_guess=np.load('final_las_9_9.npy')
las=asyn.LASSCF(mf,(4,5),((0,4),(5,0)),spin_sub=(5,6),verbose=4) # spin is 2S+1
las.set_fragments_(([17],[19]),mo_guess)
las.mo_coeff=mo_guess
from mrh.my_pyscf.lassi import states
las=states.spin_shuffle(las)
for _ in range(r):
    las=states.all_single_excitations(las)
ncsf=las.get_ugg().ncsf_sub
lroots=np.minimum(n,ncsf)
las.lasci()
las.lasci(lroots=lroots)
e_roots, si= las.lassi(opt=1)
import numpy as np
import sys
from pyscf import gto, scf, tools,lib, mcscf
from pyscf.mcscf import avas,project_init_guess
from pyscf import mcscf
from mrh.my_pyscf.tools import molden
from mrh.my_pyscf.mcscf import lasscf_async as asyn
mol_name='Al_Fe_Fe.xyz' # Al-Fe-Fe MOF node
basis={'C': 'cc-pvdz','H': 'cc-pvdz','O': 'cc-pvtz','Al': 'cc-pvtz','Fe': 'cc-pvtz'}
r=0;n=9
output='r'+str(r)+'_n'+str(n)+'.log'
mol=gto.M(atom=mol_name,verbose=4,spin=9,charge=0,basis=basis, output=output) #spin = 2S
mf=scf.RHF(mol)
mf=mf.density_fit()
mf.max_cycle=1
mf.kernel()
mf.mo_coeff=np.load('hf.npy')

mo_guess=np.load('final_las_9_9.npy')
las=asyn.LASSCF(mf,(4,5),((0,4),(5,0)),spin_sub=(5,6),verbose=4) # spin is 2S+1
las.set_fragments_(([17],[19]),mo_guess)
las.mo_coeff=mo_guess
from mrh.my_pyscf.lassi import states
las=states.spin_shuffle(las)
for _ in range(r):
    las=states.all_single_excitations(las)
ncsf=las.get_ugg().ncsf_sub
lroots=np.minimum(n,ncsf)
las.lasci()
las.lasci(lroots=lroots)
e_roots, si= las.lassi(opt=1)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0544.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 16
Python 3.9.12 (main, Apr  5 2022, 06:56:58) 
[GCC 7.5.0]
numpy 1.25.0  scipy 1.7.3
Date: Tue Feb 20 17:25:42 2024
PySCF version 2.5.0
PySCF path  /project/lgagliardi/shared/Apps/pyscf
GIT ORIG_HEAD 0bc590ffddec98eec5d2513a3d85274b7a791bc6
GIT HEAD (branch master) 6f8ce439fbe0c26ec4d226e2225b28c7f668f922

[ENV] PYSCF_MAX_MEMORY 128000
[CONFIG] conf_file /home/valayagarawal/.pyscf_conf.py
[INPUT] verbose = 4
[INPUT] num. atoms = 28
[INPUT] num. electrons = 211
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 9
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 O     -2.220198244100   0.399190300300   1.694471698900 AA   -4.195566623589   0.754360339150   3.202087436747 Bohr   0.0
[INPUT]  2 O     -1.685553244600  -1.782306321700   1.431399507200 AA   -3.185234000666  -3.368070818094   2.704953043445 Bohr   0.0
[INPUT]  3 C     -2.268517865100  -0.831955037900   1.983951274000 AA   -4.286877473722  -1.572167169583   3.749124552342 Bohr   0.0
[INPUT]  4 H     -2.913342016700  -1.076728588500   2.843786805300 AA   -5.505418518751  -2.034722142755   5.373978218669 Bohr   0.0
[INPUT]  5 O      1.388288080900   2.079556156200  -1.347085675300 AA    2.623484254899   3.929791595871  -2.545622992642 Bohr   0.0
[INPUT]  6 O     -0.759908859500   2.580923634700  -0.849227704000 AA   -1.436019624086   4.877238818000  -1.604807777953 Bohr   0.0
[INPUT]  7 C      0.346567468600   2.753895325000  -1.438835699000 AA    0.654917599338   5.204107939970  -2.719005409357 Bohr   0.0
[INPUT]  8 H      0.372379614500   3.617699659800  -2.123091150300 AA    0.703695485776   6.836461557954  -4.012060811555 Bohr   0.0
[INPUT]  9 O      1.046960908100  -2.642534200000   0.961324672200 AA    1.978469379435  -4.993665912797   1.816640347245 Bohr   0.0
[INPUT] 10 O     -0.399190300300   2.220198244100   1.694471698900 AA   -0.754360339150   4.195566623589   3.202087436747 Bohr   0.0
[INPUT] 11 O      1.782306321700   1.685553244600   1.431399507200 AA    3.368070818094   3.185234000666   2.704953043445 Bohr   0.0
[INPUT] 12 C      0.831955037900   2.268517865100   1.983951274000 AA    1.572167169583   4.286877473722   3.749124552342 Bohr   0.0
[INPUT] 13 H      1.076728588500   2.913342016700   2.843786805300 AA    2.034722142755   5.505418518751   5.373978218669 Bohr   0.0
[INPUT] 14 O     -2.079556156200  -1.388288080900  -1.347085675300 AA   -3.929791595871  -2.623484254899  -2.545622992642 Bohr   0.0
[INPUT] 15 O     -2.580923634700   0.759908859500  -0.849227704000 AA   -4.877238818000   1.436019624086  -1.604807777953 Bohr   0.0
[INPUT] 16 C     -2.753895325000  -0.346567468600  -1.438835699000 AA   -5.204107939970  -0.654917599338  -2.719005409357 Bohr   0.0
[INPUT] 17 H     -3.617699659800  -0.372379614500  -2.123091150300 AA   -6.836461557954  -0.703695485776  -4.012060811555 Bohr   0.0
[INPUT] 18 Fe    -0.379874189300  -1.792603362900  -0.200337730300 AA   -0.717858179568  -3.387529405855  -0.378583442684 Bohr   0.0
[INPUT] 19 O      0.642223180300  -2.237796553000  -1.892914517600 AA    1.213625921614  -4.228822607666  -3.577090015477 Bohr   0.0
[INPUT] 20 Fe     1.792603362900   0.379874189300  -0.200337730300 AA    3.387529405855   0.717858179568  -0.378583442684 Bohr   0.0
[INPUT] 21 O      2.237796553000  -0.642223180300  -1.892914517600 AA    4.228822607666  -1.213625921614  -3.577090015477 Bohr   0.0
[INPUT] 22 O      2.642534200000  -1.046960908100   0.961324672200 AA    4.993665912797  -1.978469379435   1.816640347245 Bohr   0.0
[INPUT] 23 Al    -1.236271642100   1.236271642100   0.350650148000 AA   -2.336214819135   2.336214819135   0.662632745258 Bohr   0.0
[INPUT] 24 O     -0.044950195400   0.044950195400   0.012762141300 AA   -0.084943558552   0.084943558552   0.024116951820 Bohr   0.0
[INPUT] 25 C      1.645528685000  -1.645528685000  -2.357112465400 AA    3.109598544766  -3.109598544766  -4.454297004404 Bohr   0.0
[INPUT] 26 H      2.056906298400  -2.056906298400  -3.294571291600 AA    3.886989567869  -3.886989567869  -6.225837438979 Bohr   0.0
[INPUT] 27 C      2.160924281100  -2.160924281100   1.277584186800 AA    4.083555067202  -4.083555067202   2.414284214127 Bohr   0.0
[INPUT] 28 H      2.796080543300  -2.796080543300   1.918244302400 AA    5.283826449062  -5.283826449062   3.624956371543 Bohr   0.0

nuclear repulsion = 3455.30471244119
number of shells = 192
number of NR pGTOs = 1065
number of NR cGTOs = 674
basis = {'C': 'cc-pvdz', 'H': 'cc-pvdz', 'O': 'cc-pvtz', 'Al': 'cc-pvtz', 'Fe': 'cc-pvtz'}
ecp = {}
CPU time:      4628.96


******** <class 'pyscf.df.df_jk.DFROHF'> ********
method = DFROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 1
direct_scf = False
chkfile to save SCF result = /scratch/local/jobs/17475336/tmpm0_yzk_w
max_memory 128000 MB (current use 7876 MB)
num. doubly occ = 101  num. singly occ = 9
Set gradient conv threshold to 3.16228e-05
******** <class 'pyscf.df.df.DF'> ********
auxbasis = None
max_memory = 128000
Even tempered Gaussians are generated as DF auxbasis for  Fe Al O H C
init E= -3971.90238344316
  HOMO = 0.121056952198061  LUMO = 0.123678658553593
cycle= 1 E= -3943.04990514114  delta_E= 28.9  |g|= 9.05  |ddm|=   34
SCF not converged.
SCF energy = -3943.04990514114
Built 4 spin(local Sz)-shuffled LAS states from 1 reference LAS states
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 0.000000e+00 ; sigma = 0.000000e+00
Cycle 1: max grad = 0.000000e+00 ; sigma = 1.065814e-14
Product_state fixed-point CI iteration converged after 1 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 7.944220e-16 ; sigma = 0.000000e+00
Cycle 1: max grad = 7.944220e-16 ; sigma = 3.552714e-15
Product_state fixed-point CI iteration converged after 1 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 2.808667e-15 ; sigma = 0.000000e+00
Cycle 1: max grad = 2.808667e-15 ; sigma = 3.552714e-15
Product_state fixed-point CI iteration converged after 1 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 1.685148e-15 ; sigma = 0.000000e+00
Cycle 1: max grad = 1.685148e-15 ; sigma = 0.000000e+00
Product_state fixed-point CI iteration converged after 1 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 3.972517e-16 ; sigma = 0.000000e+00
Cycle 1: max grad = 3.972517e-16 ; sigma = 3.552714e-15
Product_state fixed-point CI iteration converged after 1 cycles
LASSCF state-average energy = -3971.78172517509
LASSCF state 0 energy = -3971.78172517509
LASSCF state 1 energy = -3971.78544533293
LASSCF state 2 energy = -3971.78703968629
LASSCF state 3 energy = -3971.78650823517
LASSCF state 4 energy = -3971.78385097957
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 0.000000e+00 ; sigma = 0.000000e+00
Cycle 1: max grad = 0.000000e+00 ; sigma = 1.065814e-14
Product_state fixed-point CI iteration converged after 1 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 7.944220e-16 ; sigma = 0.000000e+00
Cycle 1: max grad = 7.944220e-16 ; sigma = 3.552714e-15
Product_state fixed-point CI iteration converged after 1 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 2.808667e-15 ; sigma = 0.000000e+00
Cycle 1: max grad = 2.808667e-15 ; sigma = 3.552714e-15
Product_state fixed-point CI iteration converged after 1 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 1.685148e-15 ; sigma = 0.000000e+00
Cycle 1: max grad = 1.685148e-15 ; sigma = 0.000000e+00
Product_state fixed-point CI iteration converged after 1 cycles
Entering product-state fixed-point CI iteration
Cycle 0: max grad = 3.972517e-16 ; sigma = 0.000000e+00
Cycle 1: max grad = 3.972517e-16 ; sigma = 3.552714e-15
Product_state fixed-point CI iteration converged after 1 cycles
LASSCF state-average energy = -3971.78172517509
LASSCF state 0 energy = -3971.78172517509
LASSCF state 1 energy = -3971.78544533293
LASSCF state 2 energy = -3971.78703968629
LASSCF state 3 energy = -3971.78650823517
LASSCF state 4 energy = -3971.78385097957
LASSI op_o0 memory check: 0.3588288 MB needed of 112841.822208 MB available (128000 MB max)
Symmetry analysis of 5 LAS rootspaces:
 ix            Energy  <S**2>  Neleca  Nelecb  Nelec   Wfnsym
  0  -3971.7817251751   4.750       5       4       9       A
  1  -3971.7854453329  11.750       5       4       9       A
  2  -3971.7870396863  14.750       5       4       9       A
  3  -3971.7865082352  13.750       5       4       9       A
  4  -3971.7838509796   8.750       5       4       9       A
Build + diag H matrix LASSI symmetry block 0
['neleca', 'nelecb', 'irrep'] = (5, 4, 0)
(5 rootspaces; 5 states)
LASSI eigenvalues (5 total):
 ix            Energy  <S**2>  Neleca  Nelecb  Wfnsym
  0  -3971.7923541975  24.750       5       4       A
  1  -3971.7875711374  15.750       5       4       A
  2  -3971.7838509796   8.750       5       4       A
  3  -3971.7811937240   3.750       5       4       A
  4  -3971.7795993706   0.750       5       4       A
